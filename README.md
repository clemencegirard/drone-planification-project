# Drone Planification Project
## Name
Optimizing drone trajectory in restricted environments

## Description
This project focuses on generating optimized 4D drone trajectories in a warehouse to minimize total flight time while avoiding collisions considering a safety distance between drones. The goal is to provide to the warehouse workforce a full optimized planification for the day by implementing heuristics to help buil trajectory strategy.

## Installation and Prerequisites

### Clone the repository

   ```python
   git clone https://gitlab.ec-lyon.fr/belote/drone-planification-project.git`
```

### Install dependencies
   ```python
   pip install -r requirements.txt
```

### Project Structure

The `drone-planification-project` folder is divided into 5.
- **Data_test** : sample data and images.
- **Evitement** : 
   - `avoidance.py` detects and fixes the collision and near misses in the drone planning. The cost function for the optimisation is being generated.
   - `optimisation.py` computes the simulated annealing algorithm to optimize flight time using the metropolis acceptance criteria.
- **Planification** :
   - 4 Python files :
      - `adjacency_matrix.py` computes the adjacency matrix considering our warehouse modelisation and checkpoints connections.
      - `bellman.py` contains the Bellman algorithm to find the shortest path for each trajectory using the adjacency_matrix generated by the previous Python file.
      - `planification.py` 
      - `task_list_generator.py` for testing purpose, generates a random task list (containing the task_type, the id of the object involved, initial position of the drone, final position of the drone, start time of the task).
- **Warehouse** : 
   - `warehouse_builder.py` to create warehouse with the Warehouse3D class and the configuration file containing warehouses parameters.
   - `warehouse.py` contains the class Warehouse 3D
   - `config_warehouse.json` to register the parameters for each warehouse we are using to test our algorithms.

- **Visualisation** : 
   - `animation.py` computes the 3D dynamic trajectories of the drones in the warehouse using the      library plotly.
   - `drone_animation.html` is the HTML output of the `animation.py` file


### How to use

#### In the Warehouse.config_warehouse.json
The configuration file `config_warehouse.json` contains a dictionnary with caracteristics for every warehouse. To create a new create a new warehouse, it is necessary to follow the following structure : 
- dimensions
- mat_capacity
- shelves 
- storage_line : "vertical" and "horizontal"
- objects
- start mat
- finish start
- charging station 
- checkpoints
- checkpoint_connection

#### In the Planification.config_planning.json

The configuration file `config_planning.json` contains a dictionnary with caracteristics for every planning. To create a new create a new planning, it is necessary to fill in the json file for the following :
- drone_quantity
- object_time_treatment
- drone_speed 
- battery : "max_capacity" and "initial_charge", "upper_threshold", "lower_threshold", "charger_speed"

#### For the main.py file
The main.py Python file contains the entire pipeline for the project. The user can modify the parameters according to his needs : 
- *warehouse_name* : to select the warehouse to work on the configurations JSON file
- *n_objects* : the number of objects that needs to be treated in the warehouse for this day
- *arrival_time_slots* : defines the time slots when objects are arriving on the starting mats
- *arrival_time_slots* : defines the time slots when objects are leaving to the final mats

*NB : seed enables reproductibility of the results and should not be modified by the user.*

## Expected output

## Project status
Work in progress.
